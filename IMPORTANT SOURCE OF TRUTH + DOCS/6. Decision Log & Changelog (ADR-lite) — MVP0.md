# **Artifact 6 — Decision Log & Changelog (ADR-lite) — MVP0**

**Version :** v1.1  
**Date :** 2026-01-23  
**But :** journaliser *uniquement* les décisions qui changent une règle canonique (produit/UX/tech).

---

## **0\) Règle simple**

* **Une règle canonique change → 1 entrée ADR ici.**  
* Le détail “enforceable” vit dans **Artifact 3 (Contract Spec)**.  
* Le rendu UI exact vit dans **Artifact 5 (Figma Visual Truth)**.

---

## **1\) Comment écrire une ADR (format 2–5 lignes)**

Chaque ADR contient :

* **Décision** (1 phrase)  
* **Pourquoi** (1–2 phrases)  
* **Impact** (liste courte : A1/A3/A4/A5/PRD-lite)  
* **Statut** : Proposé | Adopté | Déprécié

---

## **2\) Index (décisions canoniques)**

| ID | Date | Décision (résumé) | Statut | Impact principal |
| ----- | ----- | ----- | ----- | ----- |
| ADR-001 | 2026-01-20 | Accès \= **one‑run trial** (1 seul projet, sans limite de temps) | Adopté | A3/A4/A5 |
| ADR-002 | 2026-01-20 | Trial consommé **au submit** sur `/backbox/start` (pas sur `/access`) | Adopté | A3/A4/A5 |
| ADR-003 | 2026-01-20 | Invariant **NO DELETE RESET** (suppression ≠ reset trial) | Adopté | A3/A4 |
| ADR-004 | 2026-01-20 | **Tutorless** : pas de chat ; aide \= questions‑guides \+ lien cours | Adopté | PRD/A5 |
| ADR-005 | 2026-01-20 | IA : **pas de fallback** ; **1 retry max** puis écran “IA indisponible” | Adopté | A3/A4/A5 |
| ADR-006 | 2026-01-20 | Trial : **quota d’évaluations** \+ consommation **sur succès uniquement** | Adopté | A3/A4/A5 |
| ADR-007 | 2026-01-20 | **Rate‑limit global** (évals/heure/user) | Adopté | A3/A4/A5 |
| ADR-008 | 2026-01-20 | Export autorisé **uniquement si finalRecap existe** (sinon 409\) | Adopté | A3/A4/A5 |
| ADR-009 | 2026-01-21 | Contrat erreurs : **400/401/403/404/409/429/500** \+ `AI_UNAVAILABLE`, `EVALUATION_IN_PROGRESS` | Adopté | A3/A4/A5 |
| ADR-010 | 2026-01-21 | CTA upgrade canonique \= **« Passer Premium »** (forme unique) | Adopté | A5 |
| ADR-011 | 2026-01-23 | **Freeze MVP0** : routes \+ états \+ microcopy figés (proto v4) | Adopté | A5 |
| ADR-012 | 2026-01-28 | **ORM = Prisma** (verrouillé MVP0) | Adopté | Tech/Repo |
| ADR-013 | 2026-01-28 | **Paiements = LemonSqueezy** (verrouillé MVP0) | Adopté | Tech/Repo |

---

## **3\) ADRs (détails, version courte)**

### **ADR-001 — One‑run trial**

**Décision :** un user non‑payant a droit à **1 seul projet** en essai, sans limite de temps.  
**Pourquoi :** simplicité produit \+ conversion (2e projet \= upgrade).  
**Impact :** A3 règles d’accès ; A4 scénarios “2e projet” ; A5 états “Nouveau texte” désactivé.

### **ADR-002 — Consommation du trial au submit `/backbox/start`**

**Décision :** l’essai est consommé quand le texte est validé et que le projet trial est créé.  
**Pourquoi :** éviter de “brûler” l’essai trop tôt.  
**Impact :** A3 `startTrialProject` ; A4 “access → start” ; A5 flow.

### **ADR-003 — NO DELETE RESET**

**Décision :** supprimer le projet trial ne réactive jamais un nouvel essai (invariant).  
**Pourquoi :** anti‑abus et réduction d’états UI (pas d’UI delete en MVP0).  
**Impact :** A3 invariant table/user ; A4 tests de suppression.

### **ADR-004 — Tutorless (no chat)**

**Décision :** pas de conversation ; aide \= questions‑guides statiques (≤5/pilier) \+ “Voir le cours”.  
**Pourquoi :** réduire surface IA, UX et QA.  
**Impact :** PRD No‑list ; A5 sidebar/help.

### **ADR-005 — IA sans fallback (1 retry max)**

**Décision :** action “Évaluer” \= **1 retry max** ; si échec → écran “IA indisponible” (CTAs : “Réessayer plus tard” \+ “Retour au pilier”).  
**Pourquoi :** éviter un second produit “sans IA” \+ réduire complexité.  
**Impact :** A3 retry rules ; A4 panne IA ; A5 états AI\_UNAVAILABLE.

### **ADR-006 — Quota trial d’évaluations (consommation sur succès)**

**Décision :** en trial, les évaluations sont limitées ; le compteur n’incrémente **que si** un résultat est sauvegardé.  
**Pourquoi :** maîtrise coûts \+ ne pas pénaliser une panne IA.  
**Impact :** A3 counters atomiques ; A4 429 QUOTA ; A5 écran quota \+ CTA Premium.

### **ADR-007 — Rate‑limit global**

**Décision :** limite horaire d’évaluations par user (trial & premium).  
**Pourquoi :** protection spam/coût simple et homogène.  
**Impact :** A3 limiter ; A4 429 RATE\_LIMIT ; A5 écran rate‑limit.

### **ADR-008 — Export conditionné au finalRecap**

**Décision :** export/print seulement si `finalRecap` existe ; sinon 409 `FINAL_REQUIRED`.  
**Pourquoi :** export \= livrable final, évite états “à moitié”.  
**Impact :** A3 guard ; A4 tests ; A5 erreur 409\.

### **ADR-009 — Contrat d’erreurs normalisé**

**Décision :** HTTP : 400/401/403/404/409/429/500 \+ `errorCode` (dont `AI_UNAVAILABLE`, `EVALUATION_IN_PROGRESS`).  
**Pourquoi :** mapping UI↔API stable et QA plus simple.  
**Impact :** A3 schema ; A4 scénarios ; A5 mapping d’écrans.

### **ADR-010 — Copy upgrade canonique**

**Décision :** CTA upgrade unique : **« Passer Premium »** (sans variante).  
**Pourquoi :** cohérence UI \+ tests \+ conversion.  
**Impact :** A5 microcopy ; nettoyer les anciennes variantes.

### **ADR-011 — Freeze MVP0 (proto v4)**

**Décision :** routes, états (loading/empty/error/disabled) et microcopy sont figés pour MVP0.  
**Pourquoi :** éviter les dérives pendant dev/QA.  
**Impact :** A5 vérité UI ; A4 tests de régression.

### **ADR-012 — ORM = Prisma (verrouillé)**

**Date :** 2026-01-28  
**Décision :** L'ORM du projet est Prisma. Aucun changement d'ORM en MVP0.  
**Pourquoi :** Stabilité ; éviter la dérive tech pendant le dev MVP.  
**Preuves :** `packages/database/prisma/schema.prisma`, `packages/database/package.json` (deps prisma 7.1.0)  
**Impact :** Tech baseline  
**Statut :** Adopté

### **ADR-013 — Paiements = LemonSqueezy (verrouillé)**

**Date :** 2026-01-28  
**Décision :** Le provider de paiement actif est LemonSqueezy. Pas de changement en MVP0.  
**Pourquoi :** Stabilité ; éviter la dérive tech pendant le dev MVP.  
**Preuves :** `packages/payments/provider/index.ts` exporte uniquement `./lemonsqueezy`  
**Impact :** Tech baseline  
**Statut :** Adopté

---

## **4\) Drapeaux de cohérence (à corriger si encore présents ailleurs)**

* **Retry IA** : la règle canonique est **1 retry max**. Éliminer toute occurrence “2 retries max” restante (sinon divergence A3/A5).  
* **CTA upgrade** : la forme canonique est **« Passer Premium »**. Supprimer “Passer en Premium”, “Upgrade”, etc.  
* **Deux limiteurs** : quota trial \+ rate‑limit global coexistent (OK si assumé) → s’assurer que l’UI et l’ordre de priorité des 429 est unique et testée.

---

## **5\) Backlog (à logguer seulement si tranché)**

* Watermark trial sur export : oui/non.  
* Politique email vérifié : requis pour trial ?  
* Bibliothèque “textes classiques” incluse en MVP0 ?

---

## **6\) Template (copier/coller)**

**ADR-XXX —**  
**Date :** YYYY-MM-DD  
**Décision :** …  
**Pourquoi :** …  
**Impact :** PRD-lite / A3 / A4 / A5 / Annex 1  
**Statut :** Proposé | Adopté | Déprécié

