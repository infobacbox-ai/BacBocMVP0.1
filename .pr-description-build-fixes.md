## Build & Dependency Fixes

Resolves build/type-check issues found in local development environment.

### Investigation Summary

**Environment**: Windows, Node.js >=20, pnpm 10.14.0

**Phase 1 Findings**:
- ❌ `pnpm -w type-check` - **FAILED** with 20 TypeScript errors
- ❌ `pnpm -w build` - **FAILED** (blocked by type-check errors)
- ❌ `pnpm check:prod-mocks` - **FAILED** (blocked by build failure)

**Root Causes**:
1. React 19 introduced stricter JSX type checking that broke compatibility with third-party libraries
2. Next.js Script component types don't recognize props correctly with React 19
3. AWS SDK v3 peer dependency on `tslib` not satisfied in pnpm workspace

**CI Configuration Note**: CI workflow only runs on PRs to `main`/`master` branches, so these errors were not caught on feature branches.

### Issues Fixed

#### 1. Next.js Script Component (React 19 Compatibility)

- **Files affected**: 
  - `apps/web/modules/analytics/provider/pirsch/index.tsx`
  - `apps/web/modules/analytics/provider/plausible/index.tsx`
  - `apps/web/modules/analytics/provider/umami/index.tsx`

- **Root cause**: React 19's stricter JSX type checking caused Next.js Script component to not recognize the `src` prop

- **Fix applied**: Added `@ts-expect-error` directives on the exact line before the type error with clear comments explaining the React 19 compatibility issue. Also removed useless Fragment wrappers flagged by linter.

#### 2. Third-Party Library Type Incompatibilities (React 19)

- **Files affected**:
  - `apps/web/modules/marketing/home/components/ContactForm.tsx` - Zod schema resolver
  - `apps/web/modules/saas/auth/components/OtpForm.tsx` - Implicit any type
  - `apps/web/modules/saas/organizations/components/OrganizationLogoForm.tsx` - Dropzone types
  - `apps/web/modules/saas/settings/components/TwoFactorBlock.tsx` - QRCode component
  - `apps/web/modules/saas/settings/components/UserAvatarUpload.tsx` - Dropzone types
  - `apps/web/modules/saas/start/components/StatsTileChart.tsx` - Recharts components
  - `apps/web/modules/shared/components/ClientProviders.tsx` - ThemeProvider
  - `apps/web/modules/ui/components/input-otp.tsx` - OTPInputContext slots

- **Root cause**: Third-party libraries (react-dropzone, react-qr-code, recharts, next-themes, input-otp, @hookform/resolvers) haven't yet updated their type definitions for React 19's stricter JSX types

- **Fix applied**: 
  - Added minimal `@ts-expect-error` directives with explanatory comments
  - Added explicit type annotation for OtpForm onChange handler (`value: string`)
  - All changes are non-functional and preserve runtime behavior

#### 3. AWS SDK tslib Dependency

- **Files affected**:
  - `package.json` (root)
  - `apps/web/package.json`
  - `packages/storage/package.json`
  - `pnpm-lock.yaml`

- **Root cause**: AWS SDK v3 has a peer dependency on `tslib`, but it wasn't explicitly declared. During Next.js production builds, the image-proxy route (which uses `@aws-sdk/client-s3`) failed with "Cannot find module 'tslib'" error. This is a pnpm workspace resolution issue.

- **Fix applied**: Added `tslib@^2.8.1` as dependency at three levels:
  - Root level (for pnpm hoisting and build-time resolution)
  - apps/web (direct consumer of AWS SDK)
  - packages/storage (AWS SDK package location)

### Changes

**Type Fixes**:
- 11 files with `@ts-expect-error` directives for React 19 compatibility
- 1 explicit type annotation fix for implicit any

**Dependency Updates**:
- Added `tslib@^2.8.1` to root, apps/web, and packages/storage
- Updated `pnpm-lock.yaml`

**Code Quality**:
- Removed useless Fragment wrappers in analytics providers

### Validation

✅ `pnpm -w lint` - **PASS** (413 files checked, 0 issues)
✅ `pnpm -w type-check` - **PASS** (14/14 packages)
✅ `pnpm -w build` - **PASS** (production build succeeds)
✅ `pnpm check:prod-mocks` - **PASS** (no mock code in production)

### Commit History

1. `fix(deps): resolve Next.js Script component type errors with React 19` (bace187)
2. `fix(deps): resolve third-party library type incompatibilities with React 19` (89b62e7)
3. `fix(deps): add tslib dependency for AWS SDK compatibility` (8129e87)

### Notes

**Temporary Workarounds**: The `@ts-expect-error` directives are temporary compatibility measures until third-party libraries release React 19-compatible type definitions.

**Runtime Safety**: All fixes are type-level only - no runtime behavior changes.

**Future Work**: Monitor library updates for React 19 compatibility and remove `@ts-expect-error` directives when available.

**Peer Dependency Warning**: There's a peer dependency warning for `better-call` expecting `zod@^4.0.0` but finding `3.25.76`. This is pre-existing and unrelated to these fixes.

### Base Branch

`slice-1-pr1-state-machine-core`
